#!/bin/bash

#This script will create all necessary run folders and
#  parameter files required to run 'balance'

#File location
EXEC_FILE='exec/parameters.x'
FOLDER='../model_output/'
PRIOR_FILE='${FOLDER}parameter_priors.dat'
FIXED_FILE='${FOLDER}fixed_parameters.dat'

#How many parameters will we conduct the sampling?
LINES=` cat $PRIOR_FILE | wc -l `

#How many samples? First input is samples. Default 1000.
if [ $# -lt 1 ]
then
    latinHyperCube_samples=1000
else
    latinHyperCube_samples=$1
fi

for((i=0;i<latinHyperCube_samples;i++))
    do
	fn=` printf "../${FOLDER}run%04d" $i `
	if [ ! -d $fn ]
	then
	    mkdir -pv $fn
	fi
	fn=` printf "${FOLDER}run%04d/fixed_parameters.dat" $i `
	cp $FIXED_FILE $fn
    done

#Execute parameters.x
./$EXEC_FILE $PRIOR_FILE $LINES $latinHyperCube_samples
